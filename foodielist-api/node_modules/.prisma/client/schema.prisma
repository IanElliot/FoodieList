generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Recipe {
  id          Int                @id @default(autoincrement())
  title       String
  imageUrl    String?
  sourceUrl   String?
  timeMin     Int?
  ingredients RecipeIngredient[]
  savedRecipe SavedRecipe?
  createdAt   DateTime           @default(now())
}

model Ingredient {
  id       Int                @id @default(autoincrement())
  nameNorm String             @unique
  recipes  RecipeIngredient[]
}

model RecipeIngredient {
  recipeId     Int
  ingredientId Int
  quantity     Float?
  unit         String?

  recipe     Recipe     @relation(fields: [recipeId], references: [id], onDelete: Cascade)
  ingredient Ingredient @relation(fields: [ingredientId], references: [id], onDelete: Cascade)

  @@id([recipeId, ingredientId])
}

model ListItem {
  id        Int      @id @default(autoincrement())
  nameRaw   String
  nameNorm  String
  checked   Boolean  @default(false)
  createdAt DateTime @default(now())

  @@index([nameNorm])
}

model SavedRecipe {
  recipeId Int    @id
  status   String // "saved" | "ready"
  recipe   Recipe @relation(fields: [recipeId], references: [id], onDelete: Cascade)
}
